name = "peptalk-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Workers configuration
[build]
command = "pnpm build"

# D1 Database bindings
[[d1_databases]]
binding = "DB"
database_name = "peptalk-db"
database_id = "YOUR_D1_DATABASE_ID"

# R2 Storage bindings
[[r2_buckets]]
binding = "PDF_BUCKET"
bucket_name = "peptalk-pdfs"

# KV Namespace for rate limiting
[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "YOUR_KV_NAMESPACE_ID"

# Environment variables
[vars]
ENVIRONMENT = "production"

# Secrets (set via wrangler secret put)
# - JWT_SECRET
# - RESEND_API_KEY
# - STRIPE_API_KEY
# - STRIPE_WEBHOOK_SECRET

# Development configuration
[env.development]
name = "peptalk-api-dev"

[[env.development.d1_databases]]
binding = "DB"
database_name = "peptalk-db-dev"
database_id = "YOUR_DEV_D1_DATABASE_ID"

[[env.development.r2_buckets]]
binding = "PDF_BUCKET"
bucket_name = "peptalk-pdfs-dev"

[[env.development.kv_namespaces]]
binding = "RATE_LIMIT"
id = "YOUR_DEV_KV_NAMESPACE_ID"
